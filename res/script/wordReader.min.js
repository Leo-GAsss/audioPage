function getQueryString(e){var t=window.location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]}function scrollWord(e){var t=e.getBoundingClientRect().top+window.pageYOffset;window.scrollTo(0,t-8-123)}function genEndEvent(n,o,d){var i=0;return function e(){if(window.stopFlag)return this.parentElement.className="word",window.stopFlag=!1,void(window.playFlag=!0);var t;++i<n?setTimeout((t=this,function(){t.play()}),o):(this.pause(),this.removeEventListener("ended",e),window.playFlag=!0,d&&d(this))}}function loopAudioPlay(e,t,n,o){window.playFlag&&(window.playFlag=!1,e.play(),e.addEventListener("ended",genEndEvent(t,n,o)))}function playOnce(e){loopAudioPlay(document.getElementById("Audio"+e.slice(4)),1,0,null)}function playLoop(e){var t=document.getElementById("Audio"+e.slice(4)),n=Number(document.getElementById("delay").value);loopAudioPlay(t,Number(document.getElementById("rptTimes").value),1e3*t.duration*n,null)}function autoContinue(e){if(window.stopFlag)return e.parentElement.className="word",void(window.stopFlag=!1);var t=document.getElementById("Audio"+String(Number(e.id.slice(5))+1)),n=Number(document.getElementById("delay").value),o=document.getElementById("wordContainer").children,d=Number(document.getElementById("rptTimes").value);t.parentElement!=o[o.length-1]?setTimeout(function(){scrollWord(t.parentElement),e.parentElement.className="word",t.parentElement.className="js-item-hover word",loopAudioPlay(t,d,1e3*t.duration*n,autoContinue)},1e3*e.duration*n+100):setTimeout(function(){e.parentElement.className="word",t.parentElement.className="js-item-hover word",loopAudioPlay(t,d,1e3*t.duration*n,function(e){e.parentElement.className="word",document.getElementById("stopBtn").style.display="none",window.stopFlag=!1,window.playFlag=!0})},1e3*e.duration*n+100)}function autoStart(e){if(window.playFlag){e=e.slice(4);var t=document.getElementById("Audio"+e),n=Number(document.getElementById("delay").value),o=document.getElementById("wordContainer").children,d=Number(document.getElementById("rptTimes").value);if(scrollWord(t.parentElement),t.parentElement.className="word js-item-hover",t.parentElement!=o[o.length-1]){var i=document.getElementById("stopBtn");i.style.display="",i.addEventListener("click",function(){window.stopFlag=!0,this.style.display="none"}),loopAudioPlay(t,d,1e3*t.duration*n,autoContinue)}else playLoop("loop"+e)}}function initWordList(){for(var e=document.getElementById("wordContainer"),t=e.childNodes,n=t.length-1;0<=n;n--)e.removeChild(t[n]);var o=document.getElementById("begin").value,d=document.getElementById("end").value;for(n=o-1;n<d;n++){var i=document.querySelector("#wordRow");i.content.querySelector(".wordText").innerHTML=window.wordL[n].slice(0,1).toUpperCase()+window.wordL[n].slice(1);var l=i.content.querySelector("audio");l.id="Audio"+n.toString(),l.src="https://dict.youdao.com/dictvoice?audio="+window.wordL[n];var r=i.content.querySelector(".Button.play");r.id="Play"+n.toString();var a=i.content.querySelector(".Button.loop");a.id="Loop"+n.toString();var u=i.content.querySelector(".Button.down");u.id="Down"+n.toString();var c=document.importNode(i.content,!0);document.querySelector("#wordContainer").appendChild(c)}for(n=o-1;n<d;n++)(r=document.getElementById("Play"+n.toString())).addEventListener("click",function(){playOnce(this.id)}),(a=document.getElementById("Loop"+n.toString())).addEventListener("click",function(){playLoop(this.id)}),(u=document.getElementById("Down"+n.toString())).addEventListener("click",function(){autoStart(this.id)})}function fileImport(e){e+=".txt";var t=new XMLHttpRequest;t.open("GET","res/wordList/"+e,!0),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){window.wordL=t.responseText.split("\n");for(var e=0;e<window.wordL.length;e++)window.wordL[e]=window.wordL[e].replace(/(^\s*)|(\s*$)/g,"");document.getElementById("begin").max=window.wordL.length,document.getElementById("end").max=window.wordL.length,document.getElementById("wordList").style.display=""}else 4==t.readyState&&404==t.status&&(alert("Invalid Word List!"),window.location.href="index.html")},t.send(null)}window.wordL=[],window.stopFlag=!1,window.playFlag=!0,window.Position={},window.Position.getAbsolute=function(e,t){for(var n={left:-t.clientLeft,top:-t.clientTop},o=t;o!=e&&o!=document;)n.left=n.left+o.offsetLeft+o.clientLeft,n.top=n.top+o.offsetTop+o.clientTop,o=o.parentNode;return isNaN(e.scrollLeft)?(n.right=document.documentElement.scrollWidth-n.left,n.bottom=document.documentElement.scrollHeight-n.top):(n.right=e.scrollWidth-n.left,n.bottom=e.scrollHeight-n.top),n},window.Position.getViewport=function(e){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,o=this.getAbsolute(document,e);return{left:o.left-n,top:o.top-t}},document.addEventListener("DOMContentLoaded",function(){var e=getQueryString("wordList");if(!e)return alert("Please Select One First!"),void(window.location.href="index.html");fileImport(e),document.getElementById("start").addEventListener("click",function(){initWordList()})});